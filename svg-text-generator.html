<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animated SVG Text Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&family=Roboto:wght@100;200;300;400;500;600;700;800;900&family=Montserrat:wght@100;200;300;400;500;600;700;800;900&family=Playfair+Display:wght@400;500;600;700;800;900&family=Oswald:wght@200;300;400;500;600;700&family=Merriweather:wght@300;400;700;900&family=Bebas+Neue&family=Pacifico&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }

        /* Base styles for the SVG text element - only defining line properties here, width is set dynamically */
        #animatedText {
            stroke-linecap: round;
        }
    </style>
</head>
<body class="p-4 sm:p-8 min-h-screen flex items-center justify-center">

    <div class="w-full max-w-4xl bg-white shadow-2xl rounded-xl p-6 md:p-10">
        <h1 class="text-3xl font-extrabold text-gray-800 mb-8 border-b-2 pb-3">SVG Text Animation Generator</h1>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            
            <div class="col-span-3 grid grid-cols-1 md:grid-cols-3 gap-6 p-4 bg-indigo-50 rounded-lg border border-indigo-200">
                <div class="col-span-1">
                    <label for="inputText" class="block text-sm font-bold text-gray-700 mb-1">Text Content</label>
                    <input type="text" id="inputText" value="Animated SVG" placeholder="Enter your text here"
                            class="w-full p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-lg">
                </div>
                
                <div class="col-span-1">
                    <label for="animationStyle" class="block text-sm font-bold text-gray-700 mb-1">Animation Style</label>
                    <select id="animationStyle"
                            class="w-full p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-lg appearance-none bg-white">
                        <option value="stroke-draw">Stroke Draw (Outline + Fill)</option>
                        <option value="fill-fade">Fill Fade (Opacity)</option>
                        <option value="letters-fade-in">Letters Fade In (Staggered)</option>
                    </select>
                </div>

                <div class="col-span-1">
                    <label for="duration" class="block text-sm font-bold text-gray-700 mb-1">Duration (seconds)</label>
                    <input type="number" id="duration" value="3" min="0.5" step="0.5"
                            class="w-full p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-lg">
                </div>
            </div>

            <div class="col-span-3 grid grid-cols-1 md:grid-cols-3 lg:grid-cols-3 gap-6 p-4 bg-white rounded-lg border border-gray-200 shadow-inner">
                
                <div class="col-span-1 md:col-span-3 lg:col-span-3">
                    <label for="fontFamily" class="block text-sm font-bold text-gray-700 mb-1">Font Family</label>
                    <select id="fontFamily"
                            class="w-full p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-lg appearance-none bg-white">
                        </select>
                </div>
                
                <div class="col-span-1 lg:col-span-1">
                    <label for="fontSize" class="block text-sm font-bold text-gray-700 mb-1">Size (px)</label>
                    <input type="number" id="fontSize" value="60" min="10" max="90" step="5"
                            class="w-full p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-lg">
                </div>
                
                <div class="col-span-1 lg:col-span-1">
                    <label for="letterSpacing" class="block text-sm font-bold text-gray-700 mb-1">Spacing (px)</label>
                    <input type="number" id="letterSpacing" value="0" min="-5" max="10" step="0.1"
                            class="w-full p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-lg">
                </div>
                
                <div class="col-span-1 lg:col-span-1">
                    <label for="fontWeight" class="block text-sm font-bold text-gray-700 mb-1">Weight</label>
                    <select id="fontWeight"
                            class="w-full p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-lg appearance-none bg-white">
                        <option value="900">Black (900)</option>
                        <option value="800">Extra Bold (800)</option>
                        <option value="700" selected>Bold (700)</option>
                        <option value="600">Semi Bold (600)</option>
                        <option value="500">Medium (500)</option>
                        <option value="400">Normal (400)</option>
                        <option value="300">Light (300)</option>
                        <option value="200">Extra Light (200)</option>
                        <option value="100">Thin (100)</option>
                    </select>
                </div>
                
                <div class="col-span-1 lg:col-span-1">
                    <label for="strokeWidth" class="block text-sm font-bold text-gray-700 mb-1">Stroke Width (px)</label>
                    <select id="strokeWidth"
                            class="w-full p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-lg appearance-none bg-white">
                        <option value="1">1 px</option>
                        <option value="2" selected>2 px</option>
                        <option value="3">3 px</option>
                        <option value="4">4 px</option>
                        <option value="5">5 px</option>
                    </select>
                </div>

                <div class="col-span-1 lg:col-span-1">
                    <label for="strokeColor" class="block text-sm font-bold text-gray-700 mb-1">Stroke Color</label>
                    <input type="color" id="strokeColor" value="#4f46e5"
                            class="w-full h-10 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 p-1">
                </div>

                <div class="col-span-1 lg:col-span-1">
                    <label for="fillColor" class="block text-sm font-bold text-gray-700 mb-1">Final Fill Color</label>
                    <input type="color" id="fillColor" value="#10b981"
                            class="w-full h-10 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 p-1">
                </div>
            </div>
        </div>

        <div class="flex flex-col sm:flex-row gap-4 mb-8">
            <button id="generateBtn"
                    class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition duration-150 ease-in-out transform hover:scale-[1.01]">
                Create & Preview SVG Animation
            </button>
            <button id="copyBtn" disabled
                    class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition duration-150 ease-in-out disabled:opacity-50">
                Copy Animated HTML
            </button>
        </div>

        <!-- The container now maintains a flexible height based on the SVG's aspect ratio -->
        <div class="mt-8 border-4 border-dashed border-indigo-200 rounded-xl p-6 flex justify-center items-center bg-gray-100 min-h-[10rem] shadow-inner">
            <div id="svgContainer" class="w-full h-auto flex justify-center items-center">
                <p id="placeholderText" class="text-gray-500 italic">Click "Create & Preview SVG Animation" to see your animated text here.</p>
            </div>
        </div>

        <div id="successModal" class="fixed inset-0 bg-gray-900 bg-opacity-70 hidden items-center justify-center p-4 z-50">
            <div class="bg-white p-6 rounded-lg shadow-2xl text-center">
                <div class="text-green-500 text-4xl mb-3">ðŸŽ‰</div>
                <p class="text-gray-800 font-semibold text-lg">HTML copied successfully!</p>
                <button onclick="document.getElementById('successModal').classList.add('hidden');document.getElementById('successModal').classList.remove('flex');"
                        class="mt-4 bg-indigo-600 hover:bg-indigo-700 text-white py-2 px-4 rounded-lg shadow">
                    Awesome!
                </button>
            </div>
        </div>

    </div>

    <script>
        // Global utility to show modal
        const showModal = (id) => {
            const modal = document.getElementById(id);
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        };

        const GOOGLE_FONTS = [
            { name: "Inter", value: "Inter, sans-serif" },
            { name: "Roboto", value: "Roboto, sans-serif" },
            { name: "Montserrat", value: "Montserrat, sans-serif" },
            { name: "Playfair Display", value: "'Playfair Display', serif" },
            { name: "Oswald", value: "Oswald, sans-serif" },
            { name: "Merriweather", value: "Merriweather, serif" },
            { name: "Bebas Neue", value: "'Bebas Neue', sans-serif" },
            { name: "Pacifico", value: "Pacifico, cursive" },
            { name: "Space Mono", value: "'Space Mono', monospace" },
            { name: "--- System Fonts ---", value: "", disabled: true },
            { name: "Times New Roman", value: "'Times New Roman', serif" },
            { name: "Courier New", value: "'Courier New', monospace" },
        ];

        function loadGoogleFonts() {
            const selectEl = document.getElementById('fontFamily');
            selectEl.innerHTML = '';
            
            GOOGLE_FONTS.forEach(font => {
                const option = document.createElement('option');
                option.value = font.value;
                option.textContent = font.name;
                if (font.disabled) {
                    option.disabled = true;
                }
                selectEl.appendChild(option);
            });
        }

        document.getElementById('generateBtn').addEventListener('click', generateSVG);

        function generateSVG() {
            const text = document.getElementById('inputText').value || 'SVG Text';
            const fontFamily = document.getElementById('fontFamily').value;
            const duration = parseFloat(document.getElementById('duration').value) || 3;
            const fontSize = parseInt(document.getElementById('fontSize').value) || 60; 
            const letterSpacing = parseFloat(document.getElementById('letterSpacing').value) || 0;
            const fontWeight = document.getElementById('fontWeight').value || '700';
            const strokeWidth = document.getElementById('strokeWidth').value || '2';
            const strokeColor = document.getElementById('strokeColor').value;
            const fillColor = document.getElementById('fillColor').value;
            const animationStyle = document.getElementById('animationStyle').value;
            const svgContainer = document.getElementById('svgContainer');
            const copyBtn = document.getElementById('copyBtn');
            const placeholderText = document.getElementById('placeholderText');

            if (placeholderText) placeholderText.remove();
            svgContainer.innerHTML = '';
            copyBtn.disabled = true;

            if (!text.trim()) {
                svgContainer.innerHTML = '<p class="text-red-500 italic">Please enter some text.</p>';
                return;
            }
            
            // Text to be split into characters (including spaces)
            const characters = text.split('');
            const textContentWithoutSpaces = text.replace(/\s/g, '');
            const totalChars = textContentWithoutSpaces.length;


            // --- 1. Create temporary SVG structure to measure text (Still needed for stroke-draw animation path length) ---
            let textPathLength = 0;
            let textMetrics = { width: 0, height: 0, charWidths: [] };
            const PADDING = 20; 

            // 1. Setup the main measurement environment (tempSvg)
            const tempSvg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            // Set styles that affect measurement
            tempSvg.style.fontSize = `${fontSize}px`; 
            tempSvg.style.fontWeight = fontWeight;
            tempSvg.style.fontFamily = fontFamily;
            tempSvg.style.letterSpacing = `${letterSpacing}px`; // Apply spacing here for full text measurement
            
            // Hide for measurement
            tempSvg.style.visibility = 'hidden';
            tempSvg.style.position = 'absolute';
            tempSvg.style.left = '-9999px';
            document.body.appendChild(tempSvg);
            
            // 2. Element for FULL text measurement (Stroke Draw/Fill Fade)
            const tempFullText = document.createElementNS("http://www.w3.org/2000/svg", "text");
            tempFullText.textContent = text;
            tempSvg.appendChild(tempFullText);

            try {
                // GetTotalLength is used for stroke animation
                textMetrics.width = tempFullText.getBBox().width;
                textMetrics.height = tempFullText.getBBox().height;
                textPathLength = tempFullText.getTotalLength();
            } catch (e) {
                // Fallback for environments where SVG methods fail
                const BASE_FONT_SIZE = 60;
                const fallbackPathLength = text.length * 150 + (letterSpacing * text.length * 2); 
                textMetrics.width = Math.ceil((fontSize / BASE_FONT_SIZE) * fallbackPathLength);
                textMetrics.height = fontSize * 1.2;
                textPathLength = textMetrics.width;
                console.warn("Could not calculate accurate text metrics. Using scaled fallback.");
            }
            
            // 3. Calculate individual character widths (needed for letters-fade-in positioning)
            let currentX = 0;
            // Create a temporary element specifically for character measurement
            const tempChar = document.createElementNS("http://www.w3.org/2000/svg", "text");
            // Must explicitly set letter-spacing to 0 on this element to get pure character width
            tempChar.style.letterSpacing = '0px'; 
            tempSvg.appendChild(tempChar);

            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                if (char.trim() === '') {
                    // Estimate space width
                    const spaceWidth = fontSize * 0.4 + letterSpacing;
                    textMetrics.charWidths.push(spaceWidth);
                    currentX += spaceWidth;
                    continue;
                }
                
                tempChar.textContent = char; // Mutating only the dedicated character element
                try {
                    // Use getBBox().width which is more reliable than getComputedTextLength()
                    // Add the letterSpacing manually since we set it to 0px above.
                    const charWidth = tempChar.getBBox().width + letterSpacing; 
                    textMetrics.charWidths.push(charWidth);
                    currentX += charWidth;
                } catch (e) {
                    // Fallback for single character measurement
                    const charWidthFallback = fontSize * 0.6 + letterSpacing;
                    textMetrics.charWidths.push(charWidthFallback);
                    currentX += charWidthFallback;
                }
            }
            
            // Clean up
            tempSvg.remove();
            // --- END Measurement ---


            // --- 2. Create the final, animated SVG structure ---
            const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            svg.setAttribute('width', '100%');
            
            // --- START USER REQUEST: Fixed viewBox 0 0 600 150 ---
            const FIXED_VIEWBOX_WIDTH = 600;
            const FIXED_VIEWBOX_HEIGHT = 150;
            const textXPosition = 10; // Fixed padding
            const textYPosition = FIXED_VIEWBOX_HEIGHT / 2; // Center Y coordinate within 100px height

            svg.setAttribute('viewBox', `0 0 ${FIXED_VIEWBOX_WIDTH} ${FIXED_VIEWBOX_HEIGHT}`); 
            svg.setAttribute('preserveAspectRatio', 'xMidYMid meet'); 
            // --- END USER REQUEST ---


            // --- GENERATE DYNAMIC CSS STYLES based on animation style ---
            let animationStyles = '';

            if (animationStyle === 'stroke-draw') {
                const fillDelay = duration * 0.7;
                const fillDuration = duration - fillDelay;

                animationStyles = `
                    #animatedText {
                        stroke-dasharray: ${textPathLength};
                        stroke-dashoffset: ${textPathLength};
                        stroke: ${strokeColor};
                        fill: transparent;
                        opacity: 1;

                        animation:
                            stroke-draw-path ${duration}s ease-in-out forwards,
                            fill-fade-color ${fillDuration.toFixed(2)}s forwards;

                        animation-delay: 0s, ${fillDelay.toFixed(2)}s;
                    }

                    @keyframes stroke-draw-path {
                        to {
                            stroke-dashoffset: 0;
                        }
                    }

                    @keyframes fill-fade-color {
                        from {
                            fill: transparent;
                        }
                        to {
                            fill: ${fillColor};
                        }
                    }
                `;
            } else if (animationStyle === 'fill-fade') {
                animationStyles = `
                    #animatedText {
                        stroke: transparent;
                        fill: ${fillColor};
                        opacity: 0;

                        animation: fill-fade-opacity ${duration}s ease-out forwards;
                    }

                    @keyframes fill-fade-opacity {
                        to {
                            opacity: 1;
                        }
                    }
                `;
            } else if (animationStyle === 'letters-fade-in') {
                // Staggered letter animation (max 0.2s delay per char, total animation duration controls total time)
                const charDuration = Math.max(0.2, duration / totalChars * 0.75); // Individual char animation time
                const staggerDelay = (duration - charDuration) / totalChars; // Time gap between chars

                animationStyles = `
                    .fade-char {
                        stroke: transparent;
                        fill: ${fillColor};
                        opacity: 0;
                        animation: letter-fade ${charDuration.toFixed(2)}s ease-out forwards;
                    }

                    @keyframes letter-fade {
                        0% { opacity: 0; }
                        100% { opacity: 1; }
                    }
                    /* Custom animation delays will be applied inline */
                `;
            }
            // --- END GENERATE DYNAMIC CSS STYLES ---

            // Embed a custom style block inside the SVG for preview purposes
            const style = document.createElementNS("http://www.w3.org/2000/svg", "style");
            style.setAttribute('type', 'text/css');
            style.textContent = animationStyles;
            svg.appendChild(style);

            // Base style attributes for all text elements
            const baseTextStyle = `
                font-size: ${fontSize}px;
                font-weight: ${fontWeight};
                font-family: ${fontFamily};
                dominant-baseline: central;
                stroke-width: ${strokeWidth};
            `;

            if (animationStyle === 'letters-fade-in') {
                let currentXPosition = textXPosition; // Start position (10)
                let charIndex = 0;
                const staggerDelay = (duration / characters.length) * 0.5; // Stagger delay per character

                characters.forEach((char, i) => {
                    const charWidth = textMetrics.charWidths[i];
                    
                    const textEl = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    textEl.textContent = char;
                    textEl.setAttribute('x', currentXPosition);
                    textEl.setAttribute('y', textYPosition); // Fixed Y position (50)
                    
                    let charStyle = baseTextStyle;
                    
                    if (char.trim() !== '') {
                        // Only apply animation/delay to non-space characters
                        const delay = staggerDelay * charIndex;
                        charStyle += `animation-delay: ${delay.toFixed(3)}s;`;
                        textEl.classList.add('fade-char');
                        charIndex++; // Increment for stagger
                    } else {
                        // Apply final color to spaces immediately to maintain visual spacing integrity
                        charStyle += `fill: ${fillColor}; opacity: 1;`;
                    }

                    textEl.setAttribute('style', charStyle);
                    svg.appendChild(textEl);
                    
                    // Move X position for the next character, accounting for letter-spacing (already included in charWidth)
                    currentXPosition += charWidth;
                });
            } else {
                // Use a single text element for stroke-draw and fill-fade
                const textEl = document.createElementNS("http://www.w3.org/2000/svg", "text");
                textEl.textContent = text;
                textEl.setAttribute('x', textXPosition); // Fixed X position (10)
                textEl.setAttribute('y', textYPosition); // Fixed Y position (50)
                textEl.setAttribute('text-anchor', 'start');
                
                // Apply combined font and spacing properties as an inline style for robust rendering
                textEl.setAttribute('style', baseTextStyle + `letter-spacing: ${letterSpacing}px;`);
                textEl.id = 'animatedText';

                svg.appendChild(textEl);
            }

            svgContainer.appendChild(svg);

            copyBtn.disabled = false;
        }

        document.getElementById('copyBtn').addEventListener('click', copyAnimatedHTML);

        function getFontImport(primaryFontName) {
            // Include weights 100-900 for comprehensive font support
            const weights = "100;200;300;400;500;600;700;800;900";
            let url = "";

            switch (primaryFontName) {
                case 'Inter': url = `https://fonts.googleapis.com/css2?family=Inter:wght@${weights}&display=swap`; break;
                case 'Roboto': url = `https://fonts.googleapis.com/css2?family=Roboto:wght@${weights}&display=swap`; break;
                case 'Montserrat': url = `https://fonts.googleapis.com/css2?family=Montserrat:wght@${weights}&display=swap`; break;
                // Specific weights for fonts that don't support 100-900 evenly
                case 'Playfair Display': url = `https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;800;900&display=swap`; break;
                case 'Oswald': url = `https://fonts.googleapis.com/css2?family=Oswald:wght@200;300;400;500;600;700&display=swap`; break;
                case 'Merriweather': url = `https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700;900&display=swap`; break;
                case 'Bebas Neue': url = `https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap`; break; 
                case 'Pacifico': url = `https://fonts.googleapis.com/css2?family=Pacifico&display=swap`; break; 
                case 'Space Mono': url = `https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap`; break;
                default: return ""; 
            }
            
            // Only return the import if a URL was generated
            return url ? `@import url('${url}');` : "";
        }

        function copyAnimatedHTML() {
            const svgContainer = document.getElementById('svgContainer');
            const svgEl = svgContainer.querySelector('svg');
            const fontWeight = document.getElementById('fontWeight').value || '700';
            const fontSize = parseInt(document.getElementById('fontSize').value) || 60;
            const strokeWidth = document.getElementById('strokeWidth').value || '2';
            const letterSpacing = parseFloat(document.getElementById('letterSpacing').value) || 0;

            if (!svgEl) {
                console.error("No SVG element found to copy.");
                return;
            }

            // 1. Extract the dynamic styles from the embedded <style> element
            const styleEl = svgEl.querySelector('style');
            let dynamicStyles = '';
            if (styleEl) {
                dynamicStyles = styleEl.textContent.trim();
                // 2. Temporarily remove style from the SVG element
                styleEl.remove();
            }

            // 3. Get the raw SVG content (now without the style tag)
            const svgContent = svgEl.outerHTML;

            // 4. Get current font family and corresponding import link
            const fontFamily = document.getElementById('fontFamily').value;
            let primaryFontName = fontFamily.split(',')[0].replace(/['"]/g, '').trim();
            const fontImport = getFontImport(primaryFontName);

            // The height of the container will be fixed to the viewBox height (100)
            const finalSvgHeight = 100;


            // Generate the standalone HTML document
            const fullHtmlContent = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animated Text</title>
    <style>
        ${fontImport}
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f3f4f6;
        }
        
        .svg-container {
            /* Now using a fixed aspect ratio dictated by the 600x100 viewBox */
            width: 100%; 
            max-width: 800px; 
            /* Height is now fixed to 100px from the viewBox height for a contained look. */
            height: ${finalSvgHeight}px; 
            display: flex; 
            justify-content: center; 
            align-items: center;
        }

        /* Base styles for the SVG text element, using dynamic weight and width for consistency */
        #animatedText, .fade-char {
            stroke-width: ${strokeWidth}px; 
            stroke-linecap: round;
            /* Added Letter Spacing to the standalone CSS (Only applies to single text element animations) */
            letter-spacing: ${letterSpacing}px;
            font-weight: ${fontWeight}; /* Included for consistency */
            font-size: ${fontSize}px; /* Included for consistency */
            font-family: ${fontFamily}; /* Included for consistency */
            dominant-baseline: central; /* Included for consistency */
        }

        /* --- DYNAMIC SVG ANIMATION STYLES --- */
        ${dynamicStyles}
        /* --- END DYNAMIC SVG ANIMATION STYLES --- */
    </style>
</head>
<body>
    <div class="svg-container">
        ${svgContent}
    </div>
</body>
</html>`;

            // 5. IMPORTANT: Re-append the style element back to the SVG in the UI
            if (styleEl) {
                 svgEl.prepend(styleEl);
            }

            // Copy to clipboard
            try {
                const tempTextArea = document.createElement('textarea');
                tempTextArea.value = fullHtmlContent;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                document.execCommand('copy');
                document.body.removeChild(tempTextArea);

                showModal('successModal');
            } catch (err) {
                console.error('Failed to copy text: ', err);
                // Fallback for copy error display
                const errorModal = document.getElementById('successModal');
                errorModal.querySelector('div.text-4xl').textContent = 'âœ•';
                errorModal.querySelector('div.text-4xl').classList.replace('text-green-500', 'text-red-500');
                errorModal.querySelector('p').textContent = 'Copy failed! Check console.';
                showModal('successModal');
            }
        }

        // Initialize with fonts and a default animation on load
        window.onload = () => {
            loadGoogleFonts();

            // --- FIX: Add 'change' event listener to validate manual font size input ---
            const fontSizeInput = document.getElementById('fontSize');
            fontSizeInput.addEventListener('change', (e) => {
                const input = e.target;
                const min = parseInt(input.min, 10);
                const max = parseInt(input.max, 10);
                let value = parseInt(input.value, 10);
                
                if (isNaN(value)) {
                    input.value = 60; // Reset to default if empty or invalid
                    return;
                }

                if (value > max) {
                    input.value = max;
                } else if (value < min) {
                    input.value = min;
                }
            });
            // --- END FIX ---

            generateSVG();
        };

    </script>
</body>
</html>